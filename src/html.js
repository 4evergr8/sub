export let html = `

PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9InpoIj4KPGhlYWQ+CiAgPG1ldGEgY2hhcnNldD0iVVRGLTgiPgogIDxtZXRhIG5hbWU9InZpZXdwb3J0IiBjb250ZW50PSJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MS4wIj4KICA8dGl0bGU+Q2xhc2jphY3nva7ono3lkIg8L3RpdGxlPgogIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBzcmM9Imh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3FyY29kZS1nZW5lcmF0b3IvMS40LjQvcXJjb2RlLm1pbi5qcyI+PC9zY3JpcHQ+CiAgPHN0eWxlPgoKCiAgICBAaW1wb3J0IHVybCgnaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbS9jc3MyP2ZhbWlseT1Ob3RvK1NhbnMmZmFtaWx5PU5vdG8rU2FucytTQzp3Z2h0QDQwMCZkaXNwbGF5PXN3YXAnKTsKCiAgICAjcXJjb2RlIHsKICAgICAgbWFyZ2luOiAyMHB4IGF1dG87CiAgICAgIGRpc3BsYXk6IGJsb2NrOwogICAgICBib3JkZXI6IDJweCBzb2xpZCAjMDA3YmZmOyAvKiDovrnmoYbpopzoibIgKi8KICAgIH0KICAgICogewogICAgICBtYXJnaW46IDA7CiAgICAgIHBhZGRpbmc6IDA7CiAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7IC8qIOS9v+WuveW6puWSjOmrmOW6puiuoeeul+WMheaLrOWGhei+uei3nSAqLwogICAgfQoKICAgIGJvZHkgewogICAgICBmb250LWZhbWlseTogIk5vdG8gU2FucyIsIk5vdG8gU2FucyBTQyIsc2VyaWY7CiAgICAgIGJhY2tncm91bmQtY29sb3I6IGJsYWNrOwogICAgICBkaXNwbGF5OiBmbGV4OwogICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgICBhbGlnbi1pdGVtczogY2VudGVyOyAvKiDmsLTlubPlsYXkuK0gKi8KICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7IC8qIOWeguebtOWxheS4rSAqLwogICAgICBoZWlnaHQ6IDEwMHZoOyAvKiDop4blj6Ppq5jluqYgKi8KICAgICAgbWFyZ2luOiAwOyAvKiDljrvmjonpu5jorqTnmoTovrnot50gKi8KCiAgICB9CgoKICAgIGgxIHsKICAgICAgZm9udC1zaXplOiAzMHB4OwogICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7IC8qIOagh+mimOWxheS4rSAqLwogICAgICBjb2xvcjogYmxhY2s7IC8qIOWtl+S9k+minOiJsiAqLwogICAgICBtYXJnaW46IDEwcHg7IC8qIOi+uei3nSAqLwogICAgfQogICAgaDIgewogICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7IC8qIOagh+mimOWxheS4rSAqLwogICAgICBjb2xvcjogYmxhY2s7IC8qIOWtl+S9k+minOiJsiAqLwogICAgICBtYXJnaW46IDEwcHg7IC8qIOi+uei3nSAqLwogICAgfQogICAgaDMgewogICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7IC8qIOagh+mimOWxheS4rSAqLwogICAgICBjb2xvcjogYmxhY2s7IC8qIOWtl+S9k+minOiJsiAqLwogICAgICBtYXJnaW46IDEwcHg7IC8qIOi+uei3nSAqLwogICAgfQoKCiAgICAuaW5wdXQtZ3JvdXAgewogICAgICBkaXNwbGF5OiBmbGV4OyAvKiDkvb/nlKjlvLnmgKfluIPlsYAgKi8KICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7IC8qIOWxheS4reWvuem9kCAqLwogICAgICBtYXJnaW4tYm90dG9tOiAyMHB4OyAvKiDkuIvovrnot50gKi8KICAgIH0KCiAgICBsYWJlbCB7CiAgICAgIGZvbnQtc2l6ZTogMThweDsgLyog5qCH562+5a2X5L2T5aSn5bCPICovCiAgICAgIG1hcmdpbjogMTBweDsgLyog6L656LedICovCiAgICAgIGFsaWduLXNlbGY6IGNlbnRlcjsgLyog5Z6C55u05bGF5LitICovCiAgICB9CgoKICAgIGlucHV0W3R5cGU9InRleHQiXSB7CiAgICAgIG1hcmdpbjogMTBweDsgLyog5q+P5Liq5oyJ6ZKu5ZGo5Zu05pyJMTBweOeahOmXtOi3nSAqLwogICAgICBwYWRkaW5nOiAxMHB4OyAvKiDlhoXovrnot50gKi8KICAgICAgYm9yZGVyOiAycHggc29saWQgIzAwN2JmZjsgLyog6L655qGG6aKc6ImyICovCiAgICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7IC8qIOWchuinkiAqLwogICAgICBmb250LXNpemU6IDE2cHg7IC8qIOWtl+S9k+Wkp+WwjyAqLwogICAgICB3aWR0aDogMjAwcHg7IC8qIOi+k+WFpeahhuWuveW6piAqLwogICAgICB0cmFuc2l0aW9uOiBib3JkZXItY29sb3IgMC4zcywgYm94LXNoYWRvdyAwLjNzLCB0cmFuc2Zvcm0gMC4zczsgLyog5re75Yqg6L+H5rih5pWI5p6cICovCiAgICB9CgogICAgaW5wdXRbdHlwZT0idGV4dCJdOmZvY3VzIHsKICAgICAgYm9yZGVyLWNvbG9yOiAjMDA1NmIzOyAvKiDogZrnhKbml7bovrnmoYbpopzoibIgKi8KICAgICAgb3V0bGluZTogbm9uZTsgLyog5Y675o6J6buY6K6k55qE6L2u5buTICovCiAgICAgIGJveC1zaGFkb3c6IDAgMCA1cHggcmdiYSgwLCAxMjMsIDI1NSwgMC41KTsgLyog6IGa54Sm5pe26Zi05b2xICovCiAgICB9CgogICAgaW5wdXRbdHlwZT0idGV4dCJdOmhvdmVyIHsKICAgICAgYm94LXNoYWRvdzogMCA0cHggMTVweCByZ2JhKDAsIDEyMywgMjU1LCAwLjUpOyAvKiDmgqzlgZzml7bpmLTlvbEgKi8KICAgICAgdHJhbnNmb3JtOiBzY2FsZSgxLjEpOyAvKiDmgqzlgZzml7bkuIrnp7sgKi8KICAgIH0KCiAgICBidXR0b24gewogICAgICBmb250LWZhbWlseTogIlpDT09MIEt1YWlMZSIsIHNlcmlmOwogICAgICBtYXJnaW46IDEwcHg7IC8qIOavj+S4quaMiemSruWRqOWbtOaciTEwcHjnmoTpl7Tot50gKi8KICAgICAgcGFkZGluZzogMTBweCAxNXB4OyAvKiDlhoXovrnot50gKi8KICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzAwN2JmZjsgLyog5oyJ6ZKu6IOM5pmv6ImyICovCiAgICAgIGNvbG9yOiB3aGl0ZTsgLyog5oyJ6ZKu5a2X5L2T6aKc6ImyICovCiAgICAgIGJvcmRlcjogbm9uZTsgLyog5Y675o6J6L655qGGICovCiAgICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7IC8qIOWchuinkiAqLwogICAgICBmb250LXNpemU6IDE2cHg7IC8qIOWtl+S9k+Wkp+WwjyAqLwogICAgICBjdXJzb3I6IHBvaW50ZXI7IC8qIOm8oOagh+aMh+mSiOagt+W8jyAqLwogICAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuM3MsIGJveC1zaGFkb3cgMC4zcywgdHJhbnNmb3JtIDAuM3M7IC8qIOa3u+WKoOi/h+a4oeaViOaenCAqLwogICAgfQoKICAgIGJ1dHRvbjpob3ZlciB7CiAgICAgIGJhY2tncm91bmQtY29sb3I6ICMwMDU2YjM7IC8qIOaCrOWBnOaXtuiDjOaZr+iJsiAqLwogICAgICBib3gtc2hhZG93OiAwIDRweCAxNXB4IHJnYmEoMCwgMTIzLCAyNTUsIDAuNSk7IC8qIOaCrOWBnOaXtumYtOW9sSAqLwogICAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7IC8qIOaCrOWBnOaXtuaUvuWkpyAqLwogICAgfQoKICAgIGNhbnZhcyB7CiAgICAgIGhlaWdodDogMTAwJTsKICAgICAgbGVmdDogMDsKICAgICAgcG9zaXRpb246IGZpeGVkOwogICAgICB0b3A6IDA7CiAgICAgIHRvdWNoLWFjdGlvbjogbm9uZTsKICAgICAgd2lkdGg6IDEwMCU7CiAgICAgIHotaW5kZXg6IC0xOyAvKiDnoa7kv51jYW52YXPlnKjmiYDmnInlhoXlrrnlkI7pnaIgKi8KICAgIH0KCgoKCgogICAgLmNhcmQtYmFjayB7CgogICAgICBwYWRkaW5nOiAyMHB4OyAvKiDlhoXovrnot50gKi8KICAgICAgZGlzcGxheTogZmxleDsKICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgICAgYm94LXNoYWRvdzogMCA0cHggMTVweCByZ2JhKDAsIDAsIDAsIDAuMik7IC8qIOmYtOW9seaViOaenCAqLwogICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7IC8qIOaWh+acrOWxheS4rSAqLwogICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQodG8gcmlnaHQsIHJnYmEoNTAsIDUwLCA1MCwgMSksIHJnYmEoMjExLCAyMTEsIDIxMSwgMSkpOyAvKiDmm7Tmt6HnmoTpu5HliLDmtYXngbDnmoTmuJDlj5ggKi8KCgogICAgICBib3JkZXItcmFkaXVzOiAxNXB4OwogICAgICBib3JkZXI6IDJweCBzb2xpZCAjMDA3YmZmOyAvKiDovrnmoYbpopzoibIgKi8KICAgIH0KCgoKICA8L3N0eWxlPgoKPC9oZWFkPgo8Ym9keT4KPGNhbnZhcz48L2NhbnZhcz4KPHNjcmlwdD4KICBjb25zdCBjb252ZXJzaW9uRmFjdG9yID0gMTgwIC8gTWF0aC5QSTsKCiAgdmFyIHJhZGlhblRvRGVncmVlcyA9IGZ1bmN0aW9uKHJhZGlhbikgewogICAgcmV0dXJuIHJhZGlhbiAqIGNvbnZlcnNpb25GYWN0b3I7CiAgfQoKICB2YXIgZGVncmVlc1RvUmFkaWFuID0gZnVuY3Rpb24oZGVncmVlcykgewogICAgcmV0dXJuIGRlZ3JlZXMgLyBjb252ZXJzaW9uRmFjdG9yOwogIH0KCiAgLyoqCiAgICogQSBiYXNpYyAyRCBWZWN0b3IgY2xhc3MgdGhhdCBwcm92aWRlcyBzaW1wbGUgYWxnZWJyYWljIGZ1bmN0aW9uYWxpdHkgaW4gdGhlIGZvcm0KICAgKiBvZiAyRCBWZWN0b3JzLgogICAqCiAgICogV2UgdXNlIEdldHRlcnMvc2V0dGVycyBmb3IgYm90aCBwcmluY2lwbGUgcHJvcGVydGllcyAoeCAmIHkpIGFzIHdlbGwgYXMgdmlydHVhbAogICAqIHByb3BlcnRpZXMgKHJvdGF0aW9uLCBsZW5ndGggZXRjLikuCiAgICoKICAgKiBAY2xhc3MgVmVjdG9yCiAgICogQGF1dGhvciBMaWFtIEVnYW4gPGxpYW1Ad2V0aGVjb2xsZWN0aXZlLmNvbT4KICAgKiBAdmVyc2lvbiAwLjEuMQogICAqIEBjcmVhdGVkIERlYyAxOSwgMjAxNgogICAqLwogIGNsYXNzIFZlY3RvciB7CgogICAgLyoqCiAgICAgKiBUaGUgVmVjdG9yIENsYXNzIGNvbnN0cnVjdG9yCiAgICAgKgogICAgICogQGNvbnN0cnVjdG9yCiAgICAgKiBAcGFyYW0ge251bWJlcn0geCAJCQkJVGhlIHggY29vcmQKICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5IAkJCQlUaGUgeSBjb29yZAogICAgICovCiAgICBjb25zdHJ1Y3Rvcih4LCB5KXsKICAgICAgdGhpcy54ID0geDsKICAgICAgdGhpcy55ID0geTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlc2V0cyB0aGUgdmVjdG9yIGNvb3JkaW5hdGVzCiAgICAgKgogICAgICogQHB1YmxpYwogICAgICogQHBhcmFtIHtudW1iZXJ9IHggCQkJCVRoZSB4IGNvb3JkCiAgICAgKiBAcGFyYW0ge251bWJlcn0geSAJCQkJVGhlIHkgY29vcmQKICAgICAqLwogICAgcmVzZXQoeCwgeSkgewogICAgICB0aGlzLnggPSB4OwogICAgICB0aGlzLnkgPSB5OwogICAgfQoKICAgIC8qKgogICAgICogUmVzZXRzIHRoZSB2ZWN0b3IgY29vcmRpbmF0ZXMgdG8gYW5vdGhlciB2ZWN0b3Igb2JqZWN0CiAgICAgKgogICAgICogQHB1YmxpYwogICAgICogQHBhcmFtIHtWZWN0b3J9IHYgCQkJCVRoZSB2ZWN0b3Igb2JqZWN0IHRvIHVzZSB0byByZXNldCB0aGUgY29vcmRpbmF0ZXMKICAgICAqLwogICAgcmVzZXRUb1ZlY3Rvcih2KSB7CiAgICAgIGlmKHYgaW5zdGFuY2VvZiBWZWN0b3IpIHsKICAgICAgICB0aGlzLnggPSB2Lng7CiAgICAgICAgdGhpcy55ID0gdi55OwogICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBDbG9uZXMgdGhlIHZlY3RvcgogICAgICoKICAgICAqIEBwdWJsaWMKICAgICAqIEByZXR1cm4ge1ZlY3Rvcn0JCQkJCVRoZSBjbG9uZWQgdmVjdG9yCiAgICAgKi8KICAgIGNsb25lKCkgewogICAgICByZXR1cm4gbmV3IFZlY3Rvcih0aGlzLngsIHRoaXMueSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBZGRzIG9uZSB2ZWN0b3IgdG8gYW5vdGhlci4KICAgICAqCiAgICAgKiBAcHVibGljCiAgICAgKiBAY2hhaW5hYmxlCiAgICAgKiBAcGFyYW0gIHtWZWN0b3J9ICB2ZWN0b3IgVGhlIHZlY3RvciB0byBhZGQgdG8gdGhpcyBvbmUKICAgICAqIEByZXR1cm4ge1ZlY3Rvcn0JCQkJCVJldHVybnMgaXRzZWxmLCBtb2RpZmllZAogICAgICovCiAgICBhZGQodmVjdG9yKSB7CiAgICAgIHRoaXMueCArPSB2ZWN0b3IueDsKICAgICAgdGhpcy55ICs9IHZlY3Rvci55OwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogQ2xvbmVzIHRoZSB2ZWN0b3IgYW5kIGFkZHMgdGhlIHZlY3RvciB0byBpdCBpbnN0ZWFkCiAgICAgKgogICAgICogQHB1YmxpYwogICAgICogQGNoYWluYWJsZQogICAgICogQHBhcmFtICB7VmVjdG9yfSAgdmVjdG9yIFRoZSB2ZWN0b3IgdG8gYWRkIHRvIHRoaXMgb25lCiAgICAgKiBAcmV0dXJuIHtWZWN0b3J9CQkJCQlSZXR1cm5zIHRoZSBjbG9uZSBvZiBpdHNlbGYsIG1vZGlmaWVkCiAgICAgKi8KICAgIGFkZE5ldyh2ZWN0b3IpIHsKICAgICAgbGV0IHYgPSB0aGlzLmNsb25lKCk7CiAgICAgIHJldHVybiB2LmFkZCh2ZWN0b3IpOwogICAgfQoKICAgIC8qKgogICAgICogQWRkcyBhIHNjYWxhciB0byB0aGUgdmVjdG9yLCBtb2RpZnlpbmcgYm90aCB0aGUgeCBhbmQgeQogICAgICoKICAgICAqIEBwdWJsaWMKICAgICAqIEBjaGFpbmFibGUKICAgICAqIEBwYXJhbSAge251bWJlcn0gIHNjYWxhciBUaGUgc2NhbGFyIHRvIGFkZCB0byB0aGUgdmVjdG9yCiAgICAgKiBAcmV0dXJuIHtWZWN0b3J9CQkJCQlSZXR1cm5zIGl0c2VsZiwgbW9kaWZpZWQKICAgICAqLwogICAgYWRkU2NhbGFyKHNjYWxhcikgewogICAgICByZXR1cm4gdGhpcy5hZGQobmV3IFZlY3RvcihzY2FsYXIsIHNjYWxhcikpOwogICAgfQogICAgLyoqCiAgICAgKiBDbG9uZXMgdGhlIHZlY3RvciBhbmQgYWRkcyB0aGUgc2NhbGFyIHRvIGl0IGluc3RlYWQKICAgICAqCiAgICAgKiBAcHVibGljCiAgICAgKiBAY2hhaW5hYmxlCiAgICAgKiBAcGFyYW0gIHtudW1iZXJ9ICBzY2FsYXIgVGhlIHNjYWxhciB0byBhZGQgdG8gdGhlIHZlY3RvcgogICAgICogQHJldHVybiB7VmVjdG9yfQkJCQkJUmV0dXJucyB0aGUgY2xvbmUgb2YgaXRzZWxmLCBtb2RpZmllZAogICAgICovCiAgICBhZGRTY2FsYXJOZXcoc2NhbGFyKSB7CiAgICAgIGxldCB2ID0gdGhpcy5jbG9uZSgpOwogICAgICByZXR1cm4gdi5hZGRTY2FsYXIoc2NhbGFyKTsKICAgIH0KCiAgICAvKioKICAgICAqIFN1YnRyYWN0cyBvbmUgdmVjdG9yIGZyb20gYW5vdGhlci4KICAgICAqCiAgICAgKiBAcHVibGljCiAgICAgKiBAY2hhaW5hYmxlCiAgICAgKiBAcGFyYW0gIHtWZWN0b3J9ICB2ZWN0b3IgVGhlIHZlY3RvciB0byBzdWJ0cmFjdCBmcm9tIHRoaXMgb25lCiAgICAgKiBAcmV0dXJuIHtWZWN0b3J9CQkJCQlSZXR1cm5zIGl0c2VsZiwgbW9kaWZpZWQKICAgICAqLwogICAgc3VidHJhY3QodmVjdG9yKSB7CiAgICAgIHRoaXMueCAtPSB2ZWN0b3IueDsKICAgICAgdGhpcy55IC09IHZlY3Rvci55OwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogQ2xvbmVzIHRoZSB2ZWN0b3IgYW5kIHN1YnRyYWN0cyB0aGUgdmVjdG9yIGZyb20gaXQgaW5zdGVhZAogICAgICoKICAgICAqIEBwdWJsaWMKICAgICAqIEBjaGFpbmFibGUKICAgICAqIEBwYXJhbSAge1ZlY3Rvcn0gIHZlY3RvciBUaGUgdmVjdG9yIHRvIHN1YnRyYWN0IGZyb20gdGhpcyBvbmUKICAgICAqIEByZXR1cm4ge1ZlY3Rvcn0JCQkJCVJldHVybnMgdGhlIGNsb25lIG9mIGl0c2VsZiwgbW9kaWZpZWQKICAgICAqLwogICAgc3VidHJhY3ROZXcodmVjdG9yKSB7CiAgICAgIGxldCB2ID0gdGhpcy5jbG9uZSgpOwogICAgICByZXR1cm4gdi5zdWJ0cmFjdCh2ZWN0b3IpOwogICAgfQoKICAgIC8qKgogICAgICogU3VidHJhY3RzIGEgc2NhbGFyIGZyb20gdGhlIHZlY3RvciwgbW9kaWZ5aW5nIGJvdGggdGhlIHggYW5kIHkKICAgICAqCiAgICAgKiBAcHVibGljCiAgICAgKiBAY2hhaW5hYmxlCiAgICAgKiBAcGFyYW0gIHtudW1iZXJ9ICBzY2FsYXIgVGhlIHNjYWxhciB0byBzdWJ0cmFjdCBmcm9tIHRoZSB2ZWN0b3IKICAgICAqIEByZXR1cm4ge1ZlY3Rvcn0JCQkJCVJldHVybnMgaXRzZWxmLCBtb2RpZmllZAogICAgICovCiAgICBzdWJ0cmFjdFNjYWxhcihzY2FsYXIpIHsKICAgICAgcmV0dXJuIHRoaXMuc3VidHJhY3QobmV3IFZlY3RvcihzY2FsYXIsIHNjYWxhcikpOwogICAgfQogICAgLyoqCiAgICAgKiBDbG9uZXMgdGhlIHZlY3RvciBhbmQgc3VidHJhY3RzIHRoZSBzY2FsYXIgZnJvbSBpdCBpbnN0ZWFkCiAgICAgKgogICAgICogQHB1YmxpYwogICAgICogQGNoYWluYWJsZQogICAgICogQHBhcmFtICB7bnVtYmVyfSAgc2NhbGFyIFRoZSBzY2FsYXIgdG8gYWRkIHRvIHRoZSB2ZWN0b3IKICAgICAqIEByZXR1cm4ge1ZlY3Rvcn0JCQkJCVJldHVybnMgdGhlIGNsb25lIG9mIGl0c2VsZiwgbW9kaWZpZWQKICAgICAqLwogICAgc3VidHJhY3RTY2FsYXJOZXcoc2NhbGFyKSB7CiAgICAgIGxldCB2ID0gdGhpcy5jbG9uZSgpOwogICAgICByZXR1cm4gdi5zdWJ0cmFjdFNjYWxhcihzY2FsYXIpOwogICAgfQoKICAgIC8qKgogICAgICogRGl2aWRlcyBvbmUgdmVjdG9yIGJ5IGFub3RoZXIuCiAgICAgKgogICAgICogQHB1YmxpYwogICAgICogQGNoYWluYWJsZQogICAgICogQHBhcmFtICB7VmVjdG9yfSAgdmVjdG9yIFRoZSB2ZWN0b3IgdG8gZGl2aWRlIHRoaXMgYnkKICAgICAqIEByZXR1cm4ge1ZlY3Rvcn0JCQkJCVJldHVybnMgaXRzZWxmLCBtb2RpZmllZAogICAgICovCiAgICBkaXZpZGUodmVjdG9yKSB7CiAgICAgIGlmKHZlY3Rvci54ICE9PSAwKSB7CiAgICAgICAgdGhpcy54IC89IHZlY3Rvci54CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy54ID0gMDsKICAgICAgfQogICAgICBpZih2ZWN0b3IueSAhPT0gMCkgewogICAgICAgIHRoaXMueSAvPSB2ZWN0b3IueQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMueSA9IDA7CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENsb25lcyB0aGUgdmVjdG9yIGFuZCBkaXZpZGVzIGl0IGJ5IHRoZSB2ZWN0b3IgaW5zdGVhZAogICAgICoKICAgICAqIEBwdWJsaWMKICAgICAqIEBjaGFpbmFibGUKICAgICAqIEBwYXJhbSAge1ZlY3Rvcn0gIHZlY3RvciBUaGUgdmVjdG9yIHRvIGRpdmlkZSB0aGUgY2xvbmUgYnkKICAgICAqIEByZXR1cm4ge1ZlY3Rvcn0JCQkJCVJldHVybnMgdGhlIGNsb25lIG9mIGl0c2VsZiwgbW9kaWZpZWQKICAgICAqLwogICAgZGl2aWRlTmV3KHZlY3RvcikgewogICAgICBsZXQgdiA9IHRoaXMuY2xvbmUoKTsKICAgICAgcmV0dXJuIHYuZGl2aWRlKHZlY3Rvcik7CiAgICB9CgogICAgLyoqCiAgICAgKiBEaXZpZGVzIHRoZSB2ZWN0b3IgYnkgYSBzY2FsYXIuCiAgICAgKgogICAgICogQHB1YmxpYwogICAgICogQGNoYWluYWJsZQogICAgICogQHBhcmFtICB7bnVtYmVyfSAgc2NhbGFyIFRoZSBzY2FsYXIgdG8gZGl2aWRlIGJvdGggeCBhbmQgeSBieQogICAgICogQHJldHVybiB7VmVjdG9yfQkJCQkJUmV0dXJucyBpdHNlbGYsIG1vZGlmaWVkCiAgICAgKi8KICAgIGRpdmlkZVNjYWxhcihzY2FsYXIpIHsKICAgICAgdmFyIHYgPSBuZXcgVmVjdG9yKHNjYWxhciwgc2NhbGFyKTsKICAgICAgcmV0dXJuIHRoaXMuZGl2aWRlKHYpOwogICAgfQogICAgLyoqCiAgICAgKiBDbG9uZXMgdGhlIHZlY3RvciBhbmQgZGl2aWRlcyBpdCBieSB0aGUgcHJvdmlkZWQgc2NhbGFyLgogICAgICoKICAgICAqIEBwdWJsaWMKICAgICAqIEBjaGFpbmFibGUKICAgICAqIEBwYXJhbSAge251bWJlcn0gIHNjYWxhciBUaGUgc2NhbGFyIHRvIGRpdmlkZSBib3RoIHggYW5kIHkgYnkKICAgICAqIEByZXR1cm4ge1ZlY3Rvcn0JCQkJCVJldHVybnMgdGhlIGNsb25lIG9mIGl0c2VsZiwgbW9kaWZpZWQKICAgICAqLwogICAgZGl2aWRlU2NhbGFyTmV3KHNjYWxhcikgewogICAgICBsZXQgdiA9IHRoaXMuY2xvbmUoKTsKICAgICAgcmV0dXJuIHYuZGl2aWRlU2NhbGFyKHNjYWxhcik7CiAgICB9CgogICAgLyoqCiAgICAgKiBNdWx0aXBsaWVzIG9uZSB2ZWN0b3IgYnkgYW5vdGhlci4KICAgICAqCiAgICAgKiBAcHVibGljCiAgICAgKiBAY2hhaW5hYmxlCiAgICAgKiBAcGFyYW0gIHtWZWN0b3J9ICB2ZWN0b3IgVGhlIHZlY3RvciB0byBtdWx0aXBseSB0aGlzIGJ5CiAgICAgKiBAcmV0dXJuIHtWZWN0b3J9CQkJCQlSZXR1cm5zIGl0c2VsZiwgbW9kaWZpZWQKICAgICAqLwogICAgbXVsdGlwbHkodmVjdG9yKSB7CiAgICAgIHRoaXMueCAqPSB2ZWN0b3IueDsKICAgICAgdGhpcy55ICo9IHZlY3Rvci55OwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogQ2xvbmVzIHRoZSB2ZWN0b3IgYW5kIG11bHRpcGxpZXMgaXQgYnkgdGhlIHZlY3RvciBpbnN0ZWFkCiAgICAgKgogICAgICogQHB1YmxpYwogICAgICogQGNoYWluYWJsZQogICAgICogQHBhcmFtICB7VmVjdG9yfSAgdmVjdG9yIFRoZSB2ZWN0b3IgdG8gbXVsdGlwbHkgdGhlIGNsb25lIGJ5CiAgICAgKiBAcmV0dXJuIHtWZWN0b3J9CQkJCQlSZXR1cm5zIHRoZSBjbG9uZSBvZiBpdHNlbGYsIG1vZGlmaWVkCiAgICAgKi8KICAgIG11bHRpcGx5TmV3KHZlY3RvcikgewogICAgICBsZXQgdiA9IHRoaXMuY2xvbmUoKTsKICAgICAgcmV0dXJuIHYubXVsdGlwbHkodmVjdG9yKTsKICAgIH0KCiAgICAvKioKICAgICAqIE11bHRpcGxpZXMgdGhlIHZlY3RvciBieSBhIHNjYWxhci4KICAgICAqCiAgICAgKiBAcHVibGljCiAgICAgKiBAY2hhaW5hYmxlCiAgICAgKiBAcGFyYW0gIHtudW1iZXJ9ICBzY2FsYXIgVGhlIHNjYWxhciB0byBtdWx0aXBseSBib3RoIHggYW5kIHkgYnkKICAgICAqIEByZXR1cm4ge1ZlY3Rvcn0JCQkJCVJldHVybnMgaXRzZWxmLCBtb2RpZmllZAogICAgICovCiAgICBtdWx0aXBseVNjYWxhcihzY2FsYXIpIHsKICAgICAgdmFyIHYgPSBuZXcgVmVjdG9yKHNjYWxhciwgc2NhbGFyKTsKICAgICAgcmV0dXJuIHRoaXMubXVsdGlwbHkodik7CiAgICB9CiAgICAvKioKICAgICAqIENsb25lcyB0aGUgdmVjdG9yIGFuZCBtdWx0aXBsaWVzIGl0IGJ5IHRoZSBwcm92aWRlZCBzY2FsYXIuCiAgICAgKgogICAgICogQHB1YmxpYwogICAgICogQGNoYWluYWJsZQogICAgICogQHBhcmFtICB7bnVtYmVyfSAgc2NhbGFyIFRoZSBzY2FsYXIgdG8gbXVsdGlwbHkgYm90aCB4IGFuZCB5IGJ5CiAgICAgKiBAcmV0dXJuIHtWZWN0b3J9CQkJCQlSZXR1cm5zIHRoZSBjbG9uZSBvZiBpdHNlbGYsIG1vZGlmaWVkCiAgICAgKi8KICAgIG11bHRpcGx5U2NhbGFyTmV3KHNjYWxhcikgewogICAgICBsZXQgdiA9IHRoaXMuY2xvbmUoKTsKICAgICAgcmV0dXJuIHYubXVsdGlwbHlTY2FsYXIoc2NhbGFyKTsKICAgIH0KCiAgICAvKioKICAgICAqIEFsaWFzIG9mIHtAbGluayBWZWN0b3IjbXVsdGlwbHlTY2FsYXJfX2FuY2hvciBtdWx0aXBseVNjYWxhcn0KICAgICAqLwogICAgc2NhbGUoc2NhbGFyKSB7CiAgICAgIHJldHVybiB0aGlzLm11bHRpcGx5U2NhbGFyKHNjYWxhcik7CiAgICB9CiAgICAvKioKICAgICAqIEFsaWFzIG9mIHtAbGluayBWZWN0b3IjbXVsdGlwbHlTY2FsYXJOZXdfX2FuY2hvciBtdWx0aXBseVNjYWxhck5ld30KICAgICAqLwogICAgc2NhbGVOZXcoc2NhbGFyKSB7CiAgICAgIHJldHVybiB0aGlzLm11bHRpcGx5U2NhbGFyTmV3KHNjYWxhcik7CiAgICB9CgogICAgLyoqCiAgICAgKiBSb3RhdGVzIGEgdmVjb3IgYnkgYSBnaXZlbiBhbW91bnQsIHByb3ZpZGVkIGluIHJhZGlhbnMuCiAgICAgKgogICAgICogQHB1YmxpYwogICAgICogQGNoYWluYWJsZQogICAgICogQHBhcmFtICB7bnVtYmVyfSAgcmFkaWFuIFRoZSBhbmdsZSwgaW4gcmFkaWFucywgdG8gcm90YXRlIHRoZSB2ZWN0b3IgYnkKICAgICAqIEByZXR1cm4ge1ZlY3Rvcn0JCQkJCVJldHVybnMgaXRzZWxmLCBtb2RpZmllZAogICAgICovCiAgICByb3RhdGUocmFkaWFuKSB7CiAgICAgIHZhciB4ID0gKHRoaXMueCAqIE1hdGguY29zKHJhZGlhbikpIC0gKHRoaXMueSAqIE1hdGguc2luKHJhZGlhbikpOwogICAgICB2YXIgeSA9ICh0aGlzLnggKiBNYXRoLnNpbihyYWRpYW4pKSArICh0aGlzLnkgKiBNYXRoLmNvcyhyYWRpYW4pKTsKCiAgICAgIHRoaXMueCA9IHg7CiAgICAgIHRoaXMueSA9IHk7CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogQ2xvbmVzIHRoZSB2ZWN0b3IgYW5kIHJvdGF0ZXMgaXQgYnkgdGhlIHN1cHBsaWVkIHJhZGlhbiB2YWx1ZQogICAgICoKICAgICAqIEBwdWJsaWMKICAgICAqIEBjaGFpbmFibGUKICAgICAqIEBwYXJhbSAge251bWJlcn0gIHJhZGlhbiBUaGUgYW5nbGUsIGluIHJhZGlhbnMsIHRvIHJvdGF0ZSB0aGUgdmVjdG9yIGJ5CiAgICAgKiBAcmV0dXJuIHtWZWN0b3J9CQkJCQlSZXR1cm5zIHRoZSBjbG9uZSBvZiBpdHNlbGYsIG1vZGlmaWVkCiAgICAgKi8KICAgIHJvdGF0ZU5ldyhyYWRpYW4pIHsKICAgICAgbGV0IHYgPSB0aGlzLmNsb25lKCk7CiAgICAgIHJldHVybiB2LnJvdGF0ZShyYWRpYW4pOwogICAgfQoKICAgIC8qKgogICAgICogUm90YXRlcyBhIHZlY29yIGJ5IGEgZ2l2ZW4gYW1vdW50LCBwcm92aWRlZCBpbiBkZWdyZWVzLiBDb252ZXJ0cyB0aGUgZGVncmVlCiAgICAgKiB2YWx1ZSB0byByYWRpYW5zIGFuZCBydW5zIHRoZSByb3RhZXQgbWV0aG9kLgogICAgICoKICAgICAqIEBwdWJsaWMKICAgICAqIEBjaGFpbmFibGUKICAgICAqIEBwYXJhbSAge251bWJlcn0gIGRlZ3JlZXMgVGhlIGFuZ2xlLCBpbiBkZWdyZWVzLCB0byByb3RhdGUgdGhlIHZlY3RvciBieQogICAgICogQHJldHVybiB7VmVjdG9yfQkJCQkJCVJldHVybnMgaXRzZWxmLCBtb2RpZmllZAogICAgICovCiAgICByb3RhdGVEZWcoZGVncmVlcykgewogICAgICByZXR1cm4gdGhpcy5yb3RhdGUoZGVncmVlc1RvUmFkaWFuKGRlZ3JlZXMpKTsKICAgIH0KICAgIC8qKgogICAgICogQ2xvbmVzIHRoZSB2ZWN0b3IgYW5kIHJvdGF0ZXMgaXQgYnkgdGhlIHN1cHBsaWVkIGRlZ3JlZSB2YWx1ZQogICAgICoKICAgICAqIEBwdWJsaWMKICAgICAqIEBjaGFpbmFibGUKICAgICAqIEBwYXJhbSAge251bWJlcn0gIGRlZ3JlZXMgVGhlIGFuZ2xlLCBpbiBkZWdyZWVzLCB0byByb3RhdGUgdGhlIHZlY3RvciBieQogICAgICogQHJldHVybiB7VmVjdG9yfQkJCQkJIFJldHVybnMgdGhlIGNsb25lIG9mIGl0c2VsZiwgbW9kaWZpZWQKICAgICAqLwogICAgcm90YXRlRGVnTmV3KGRlZ3JlZXMpIHsKICAgICAgcmV0dXJuIHRoaXMucm90YXRlTmV3KGRlZ3JlZXNUb1JhZGlhbihkZWdyZWVzKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBbGlhcyBvZiB7QGxpbmsgVmVjdG9yI3JvdGF0ZV9fYW5jaG9yIHJvdGF0ZX0KICAgICAqLwogICAgcm90YXRlQnkocmFkaWFuKSB7CiAgICAgIHJldHVybiB0aGlzLnJvdGF0ZShyYWRpYW4pOwogICAgfQogICAgLyoqCiAgICAgKiBBbGlhcyBvZiB7QGxpbmsgVmVjdG9yI3JvdGF0ZU5ld19fYW5jaG9yIHJvdGF0ZU5ld30KICAgICAqLwogICAgcm90YXRlQnlOZXcocmFkaWFuKSB7CiAgICAgIHJldHVybiB0aGlzLnJvdGF0ZU5ldyhyYWRpYW4pOwogICAgfQoKICAgIC8qKgogICAgICogQWxpYXMgb2Yge0BsaW5rIFZlY3RvciNyb3RhdGVEZWdfX2FuY2hvciByb3RhdGVEZWd9CiAgICAgKi8KICAgIHJvdGF0ZURlZ0J5KGRlZ3JlZXMpIHsKICAgICAgcmV0dXJuIHRoaXMucm90YXRlRGVnKGRlZ3JlZXMpOwogICAgfQogICAgLyoqCiAgICAgKiBBbGlhcyBvZiB7QGxpbmsgVmVjdG9yI3JvdGF0ZURlZ05ld19fYW5jaG9yIHJvdGF0ZURlZ05ld30KICAgICAqLwogICAgcm90YXRlRGVnQnlOZXcocmFkaWFuKSB7CiAgICAgIHJldHVybiB0am9zLnJvdGF0ZURlZ05ldyhyYWRpYW4pOwogICAgfQoKICAgIC8qKgogICAgICogUm90YXRlcyBhIHZlY3RvciB0byBhIHNwZWNpZmljIGFuZ2xlCiAgICAgKgogICAgICogQHB1YmxpYwogICAgICogQGNoYWluYWJsZQogICAgICogQHBhcmFtICB7bnVtYmVyfSAgcmFkaWFuIFRoZSBhbmdsZSwgaW4gcmFkaWFucywgdG8gcm90YXRlIHRoZSB2ZWN0b3IgdG8KICAgICAqIEByZXR1cm4ge1ZlY3Rvcn0JCQkJCVJldHVybnMgaXRzZWxmLCBtb2RpZmllZAogICAgICovCiAgICByb3RhdGVUbyhyYWRpYW4pIHsKICAgICAgcmV0dXJuIHRoaXMucm90YXRlKHJhZGlhbi10aGlzLmFuZ2xlKTsKICAgIH07CiAgICAvKioKICAgICAqIENsb25lcyB0aGUgdmVjdG9yIGFuZCByb3RhdGVzIGl0IHRvIHRoZSBzdXBwbGllZCByYWRpYW4gdmFsdWUKICAgICAqCiAgICAgKiBAcHVibGljCiAgICAgKiBAY2hhaW5hYmxlCiAgICAgKiBAcGFyYW0gIHtudW1iZXJ9ICByYWRpYW4gVGhlIGFuZ2xlLCBpbiByYWRpYW5zLCB0byByb3RhdGUgdGhlIHZlY3RvciB0bwogICAgICogQHJldHVybiB7VmVjdG9yfQkJCQkJUmV0dXJucyB0aGUgY2xvbmUgb2YgaXRzZWxmLCBtb2RpZmllZAogICAgICovCiAgICByb3RhdGVUb05ldyhyYWRpYW4pIHsKICAgICAgbGV0IHYgPSB0aGlzLmNsb25lKCk7CiAgICAgIHJldHVybiB2LnJvdGF0ZVRvKHJhZGlhbik7CiAgICB9OwoKICAgIC8qKgogICAgICogUm90YXRlcyBhIHZlY29yIHRvIGEgZ2l2ZW4gYW1vdW50LCBwcm92aWRlZCBpbiBkZWdyZWVzLiBDb252ZXJ0cyB0aGUgZGVncmVlCiAgICAgKiB2YWx1ZSB0byByYWRpYW5zIGFuZCBydW5zIHRoZSByb3RhdGVUbyBtZXRob2QuCiAgICAgKgogICAgICogQHB1YmxpYwogICAgICogQGNoYWluYWJsZQogICAgICogQHBhcmFtICB7bnVtYmVyfSAgZGVncmVlcyBUaGUgYW5nbGUsIGluIGRlZ3JlZXMsIHRvIHJvdGF0ZSB0aGUgdmVjdG9yIHRvCiAgICAgKiBAcmV0dXJuIHtWZWN0b3J9CQkJCQkJUmV0dXJucyBpdHNlbGYsIG1vZGlmaWVkCiAgICAgKi8KICAgIHJvdGF0ZVRvRGVnKGRlZ3JlZXMpIHsKICAgICAgcmV0dXJuIHRoaXMucm90YXRlVG8oZGVncmVlc1RvUmFkaWFuKGRlZ3JlZXMpKTsKICAgIH0KICAgIC8qKgogICAgICogQ2xvbmVzIHRoZSB2ZWN0b3IgYW5kIHJvdGF0ZXMgaXQgdG8gdGhlIHN1cHBsaWVkIGRlZ3JlZSB2YWx1ZQogICAgICoKICAgICAqIEBwdWJsaWMKICAgICAqIEBjaGFpbmFibGUKICAgICAqIEBwYXJhbSAge251bWJlcn0gIGRlZ3JlZXMgVGhlIGFuZ2xlLCBpbiBkZWdyZWVzLCB0byByb3RhdGUgdGhlIHZlY3RvciB0bwogICAgICogQHJldHVybiB7VmVjdG9yfQkJCQkJIFJldHVybnMgdGhlIGNsb25lIG9mIGl0c2VsZiwgbW9kaWZpZWQKICAgICAqLwogICAgcm90YXRlVG9EZWdOZXcoZGVncmVlcykgewogICAgICByZXR1cm4gdGhpcy5yb3RhdGVUb05ldyhkZWdyZWVzVG9SYWRpYW4oZGVncmVlcykpOwogICAgfQoKICAgIC8qKgogICAgICogTm9ybWFsaXNlcyB0aGUgdmVjdG9yIGRvd24gdG8gYSBsZW5ndGggb2YgMSB1bml0CiAgICAgKgogICAgICogQHB1YmxpYwogICAgICogQGNoYWluYWJsZQogICAgICogQHJldHVybiB7VmVjdG9yfQkJCQkJUmV0dXJucyBpdHNlbGYsIG1vZGlmaWVkCiAgICAgKi8KICAgIG5vcm1hbGlzZSgpIHsKICAgICAgcmV0dXJuIHRoaXMuZGl2aWRlU2NhbGFyKHRoaXMubGVuZ3RoKTsKICAgIH0KICAgIC8qKgogICAgICogQ2xvbmVzIHRoZSB2ZWN0b3IgYW5kIG5vcm1hbGlzZXMgaXQKICAgICAqCiAgICAgKiBAcHVibGljCiAgICAgKiBAY2hhaW5hYmxlCiAgICAgKiBAcmV0dXJuIHtWZWN0b3J9CQkJCQlSZXR1cm5zIGEgY2xvbmUgb2YgaXRzZWxmLCBtb2RpZmllZAogICAgICovCiAgICBub3JtYWxpc2VOZXcoKSB7CiAgICAgIHJldHVybiB0aGlzLmRpdmlkZVNjYWxhck5ldyh0aGlzLmxlbmd0aCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDYWxjdWxhdGVzIHRoZSBkaXN0YW5jZSBiZXR3ZWVuIHRoaXMgYW5kIHRoZSBzdXBwbGllZCB2ZWN0b3IKICAgICAqCiAgICAgKiBAcGFyYW0gIHtWZWN0b3J9IHZlY3RvciBUaGUgdmVjdG9yIHRvIGNhbGN1bGF0ZSB0aGUgZGlzdGFuY2UgZnJvbQogICAgICogQHJldHVybiB7bnVtYmVyfSAgICAgICAgVGhlIGRpc3RhbmNlIGJldHdlZW4gdGhpcyBhbmQgdGhlIHN1cHBsaWVkIHZlY3RvcgogICAgICovCiAgICBkaXN0YW5jZSh2ZWN0b3IpIHsKICAgICAgcmV0dXJuIHRoaXMuc3VidHJhY3ROZXcodmVjdG9yKS5sZW5ndGg7CiAgICB9CgogICAgLyoqCiAgICAgKiBDYWxjdWxhdGVzIHRoZSBkaXN0YW5jZSBvbiB0aGUgWCBheGlzIGJldHdlZW4gdGhpcyBhbmQgdGhlIHN1cHBsaWVkIHZlY3RvcgogICAgICoKICAgICAqIEBwYXJhbSAge1ZlY3Rvcn0gdmVjdG9yIFRoZSB2ZWN0b3IgdG8gY2FsY3VsYXRlIHRoZSBkaXN0YW5jZSBmcm9tCiAgICAgKiBAcmV0dXJuIHtudW1iZXJ9ICAgICAgICBUaGUgZGlzdGFuY2UsIGFsb25nIHRoZSB4IGF4aXMsIGJldHdlZW4gdGhpcyBhbmQgdGhlIHN1cHBsaWVkIHZlY3RvcgogICAgICovCiAgICBkaXN0YW5jZVgodmVjdG9yKSB7CiAgICAgIHJldHVybiB0aGlzLnggLSB2ZWN0b3IueDsKICAgIH0KCiAgICAvKioKICAgICAqIENhbGN1bGF0ZWQgdGhlIGRpc3RhbmNlIG9uIHRoZSBZIGF4aXMgYmV0d2VlbiB0aGlzIGFuZCB0aGUgc3VwcGxpZWQgdmVjdG9yCiAgICAgKgogICAgICogQHBhcmFtICB7VmVjdG9yfSB2ZWN0b3IgVGhlIHZlY3RvciB0byBjYWxjdWxhdGUgdGhlIGRpc3RhbmNlIGZyb20KICAgICAqIEByZXR1cm4ge251bWJlcn0gICAgICAgIFRoZSBkaXN0YW5jZSwgYWxvbmcgdGhlIHkgYXhpcywgYmV0d2VlbiB0aGlzIGFuZCB0aGUgc3VwcGxpZWQgdmVjdG9yCiAgICAgKi8KICAgIGRpc3RhbmNlWSh2ZWN0b3IpIHsKICAgICAgcmV0dXJuIHRoaXMueSAtIHZlY3Rvci55OwogICAgfQoKCiAgICAvKioKICAgICAqIENhbGN1bGF0ZXMgdGhlIGRvdCBwcm9kdWN0IGJldHdlZW4gdGhpcyBhbmQgYSBzdXBwbGllZCB2ZWN0b3IKICAgICAqCiAgICAgKiBAZXhhbXBsZQogICAgICogLy8gcmV0dXJucyAtMTQKICAgICAqIG5ldyBWZWN0b3IoMiwgLTMpLmRvdChuZXcgVmVjdG9yKC00LCAyKSkKICAgICAqIG5ldyBWZWN0b3IoLTQsIDIpLmRvdChuZXcgVmVjdG9yKDIsIC0zKSkKICAgICAqIG5ldyBWZWN0b3IoMiwgLTQpLmRvdChuZXcgVmVjdG9yKC0zLCAyKSkKICAgICAqCiAgICAgKiBAcGFyYW0gIHtWZWN0b3J9IHZlY3RvciBUaGUgdmVjdG9yIG9iamVjdCBhZ2FpbnN0IHdoaWNoIHRvIGNhbGN1bGF0ZSB0aGUgZG90IHByb2R1Y3QKICAgICAqIEByZXR1cm4ge251bWJlcn0gICAgICAgIFRoZSBkb3QgcHJvZHVjdCBvZiB0aGUgdHdvIHZlY3RvcnMKICAgICAqLwogICAgZG90KHZlY3RvcikgewogICAgICByZXR1cm4gKHRoaXMueCAqIHZlY3Rvci54KSArICh0aGlzLnkgKiB2ZWN0b3IueSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDYWxjdWxhdGVzIHRoZSBjcm9zcyBwcm9kdWN0IGJldHdlZW4gdGhpcyBhbmQgdGhlIHN1cHBsaWVkIHZlY3Rvci4KICAgICAqCiAgICAgKiBAZXhhbXBsZQogICAgICogLy8gcmV0dXJucyAtMgogICAgICogbmV3IFZlY3RvcigyLCAtMykuY3Jvc3MobmV3IFZlY3RvcigtNCwgMikpCiAgICAgKiBuZXcgVmVjdG9yKC00LCAyKS5jcm9zcyhuZXcgVmVjdG9yKDIsIC0zKSkKICAgICAqIC8vIHJldHVybnMgMgogICAgICogbmV3IFZlY3RvcigyLCAtNCkuY3Jvc3MobmV3IFZlY3RvcigtMywgMikpCiAgICAgKgogICAgICogQHBhcmFtICB7VmVjdG9yfSB2ZWN0b3IgVGhlIHZlY3RvciBvYmplY3QgYWdhaW5zdCB3aGljaCB0byBjYWxjdWxhdGUgdGhlIGNyb3NzIHByb2R1Y3QKICAgICAqIEByZXR1cm4ge251bWJlcn0gICAgICAgIFRoZSBjcm9zcyBwcm9kdWN0IG9mIHRoZSB0d28gdmVjdG9ycwogICAgICovCiAgICBjcm9zcyh2ZWN0b3IpIHsKICAgICAgcmV0dXJuICh0aGlzLnggKiB2ZWN0b3IueCkgLSAodGhpcy55ICogdmVjdG9yLnkpOwogICAgfQoKCiAgICAvKioKICAgICAqIEdldHRlcnMgYW5kIHNldHRlcnMKICAgICAqLwoKICAgIC8qKgogICAgICogKGdldHRlci9zZXR0ZXIpIFRoZSB4IHZhbHVlIG9mIHRoZSB2ZWN0b3IuCiAgICAgKgogICAgICogQHR5cGUge251bWJlcn0KICAgICAqIEBkZWZhdWx0IDAKICAgICAqLwogICAgc2V0IHgoeCkgewogICAgICBpZih0eXBlb2YgeCA9PSAnbnVtYmVyJykgewogICAgICAgIHRoaXMuX3ggPSB4OwogICAgICB9IGVsc2UgewogICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1ggc2hvdWxkIGJlIGEgbnVtYmVyJyk7CiAgICAgIH0KICAgIH0KICAgIGdldCB4KCkgewogICAgICByZXR1cm4gdGhpcy5feCB8fCAwOwogICAgfQoKICAgIC8qKgogICAgICogKGdldHRlci9zZXR0ZXIpIFRoZSB5IHZhbHVlIG9mIHRoZSB2ZWN0b3IuCiAgICAgKgogICAgICogQHR5cGUge251bWJlcn0KICAgICAqIEBkZWZhdWx0IDAKICAgICAqLwogICAgc2V0IHkoeSkgewogICAgICBpZih0eXBlb2YgeSA9PSAnbnVtYmVyJykgewogICAgICAgIHRoaXMuX3kgPSB5OwogICAgICB9IGVsc2UgewogICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1kgc2hvdWxkIGJlIGEgbnVtYmVyJyk7CiAgICAgIH0KICAgIH0KICAgIGdldCB5KCkgewogICAgICByZXR1cm4gdGhpcy5feSB8fCAwOwogICAgfQoKICAgIC8qKgogICAgICogKGdldHRlci9zZXR0ZXIpIFRoZSBsZW5ndGggb2YgdGhlIHZlY3RvciBwcmVzZW50ZWQgYXMgYSBzcXVhcmUuIElmIHlvdSdyZSB1c2luZwogICAgICogbGVuZ3RoIGZvciBjb21wYXJpc29uLCB0aGlzIGlzIHF1aWNrZXIuCiAgICAgKgogICAgICogQHR5cGUge251bWJlcn0KICAgICAqIEBkZWZhdWx0IDAKICAgICAqLwogICAgc2V0IGxlbmd0aFNxdWFyZWQobGVuZ3RoKSB7CiAgICAgIHZhciBmYWN0b3I7CiAgICAgIGlmKHR5cGVvZiBsZW5ndGggPT0gJ251bWJlcicpIHsKICAgICAgICBmYWN0b3IgPSBsZW5ndGggLyB0aGlzLmxlbmd0aFNxdWFyZWQ7CiAgICAgICAgdGhpcy5tdWx0aXBseVNjYWxhcihmYWN0b3IpOwogICAgICB9IGVsc2UgewogICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2xlbmd0aCBzaG91bGQgYmUgYSBudW1iZXInKTsKICAgICAgfQogICAgfQogICAgZ2V0IGxlbmd0aFNxdWFyZWQoKSB7CiAgICAgIHJldHVybiAodGhpcy54ICogdGhpcy54KSArICh0aGlzLnkgKiB0aGlzLnkpOwogICAgfQoKICAgIC8qKgogICAgICogKGdldHRlci9zZXR0ZXIpIFRoZSBsZW5ndGggb2YgdGhlIHZlY3RvcgogICAgICoKICAgICAqIEB0eXBlIHtudW1iZXJ9CiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KICAgIHNldCBsZW5ndGgobGVuZ3RoKSB7CiAgICAgIHZhciBmYWN0b3I7CiAgICAgIGlmKHR5cGVvZiBsZW5ndGggPT0gJ251bWJlcicpIHsKICAgICAgICBmYWN0b3IgPSBsZW5ndGggLyB0aGlzLmxlbmd0aDsKICAgICAgICB0aGlzLm11bHRpcGx5U2NhbGFyKGZhY3Rvcik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignbGVuZ3RoIHNob3VsZCBiZSBhIG51bWJlcicpOwogICAgICB9CiAgICB9CiAgICBnZXQgbGVuZ3RoKCkgewogICAgICByZXR1cm4gTWF0aC5zcXJ0KHRoaXMubGVuZ3RoU3F1YXJlZCk7CiAgICB9CgogICAgLyoqCiAgICAgKiAoZ2V0dGVyL3NldHRlcikgVGhlIGFuZ2xlIG9mIHRoZSB2ZWN0b3IsIGluIHJhZGlhbnMKICAgICAqCiAgICAgKiBAdHlwZSB7bnVtYmVyfQogICAgICogQGRlZmF1bHQgMAogICAgICovCiAgICBzZXQgYW5nbGUocmFkaWFuKSB7CiAgICAgIGlmKHR5cGVvZiByYWRpYW4gPT0gJ251bWJlcicpIHsKICAgICAgICB0aGlzLnJvdGF0ZVRvKHJhZGlhbik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignYW5nbGUgc2hvdWxkIGJlIGEgbnVtYmVyJyk7CiAgICAgIH0KICAgIH0KICAgIGdldCBhbmdsZSgpIHsKICAgICAgcmV0dXJuIE1hdGguYXRhbjIodGhpcy55LCB0aGlzLngpOwogICAgfQoKICAgIC8qKgogICAgICogKGdldHRlci9zZXR0ZXIpIFRoZSBhbmdsZSBvZiB0aGUgdmVjdG9yLCBpbiByYWRpYW5zCiAgICAgKgogICAgICogQHR5cGUge251bWJlcn0KICAgICAqIEBkZWZhdWx0IDAKICAgICAqLwogICAgc2V0IGFuZ2xlSW5EZWdyZWVzKGRlZ3JlZXMpIHsKICAgICAgaWYodHlwZW9mIGRlZ3JlZXMgPT0gJ251bWJlcicpIHsKICAgICAgICB0aGlzLnJvdGF0ZVRvRGVnKGRlZ3JlZXMpOwogICAgICB9IGVsc2UgewogICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2FuZ2xlIHNob3VsZCBiZSBhIG51bWJlcicpOwogICAgICB9CiAgICB9CiAgICBnZXQgYW5nbGVJbkRlZ3JlZXMoKSB7CiAgICAgIHJldHVybiByYWRpYW5Ub0RlZ3JlZXMoTWF0aC5hdGFuMih0aGlzLnksIHRoaXMueCkpOwogICAgfQoKICAgIC8qKgogICAgICogKGdldHRlci9zZXR0ZXIpIFZlY3RvciB3aWR0aC4KICAgICAqIEFsaWFzIG9mIHtAbGluayBWZWN0b3IjeCB4fQogICAgICoKICAgICAqIEB0eXBlIHtudW1iZXJ9CiAgICAgKi8KICAgIHNldCB3aWR0aCh3KSB7CiAgICAgIHRoaXMueCA9IHc7CiAgICB9CiAgICBnZXQgd2lkdGgoKSB7CiAgICAgIHJldHVybiB0aGlzLng7CiAgICB9CgogICAgLyoqCiAgICAgKiAoZ2V0dGVyL3NldHRlcikgVmVjdG9yIGhlaWdodC4KICAgICAqIEFsaWFzIG9mIHtAbGluayBWZWN0b3IjeCB4fQogICAgICoKICAgICAqIEB0eXBlIHtudW1iZXJ9CiAgICAgKi8KICAgIHNldCBoZWlnaHQoaCkgewogICAgICB0aGlzLnkgPSBoOwogICAgfQogICAgZ2V0IGhlaWdodCgpIHsKICAgICAgcmV0dXJuIHRoaXMueTsKICAgIH0KCiAgICAvKioKICAgICAqIChnZXR0ZXIvc2V0dGVyKSBWZWN0b3IgYXJlYS4KICAgICAqIEByZWFkb25seQogICAgICoKICAgICAqIEB0eXBlIHtudW1iZXJ9CiAgICAgKi8KICAgIGdldCBhcmVhKCkgewogICAgICByZXR1cm4gdGhpcy54ICogdGhpcy55OwogICAgfQoKICAgIC8qKgogICAgICogKGdldHRlci9zZXR0ZXIpIFZlY3RvciBzbG9wZS4KICAgICAqCiAgICAgKiBAdHlwZSB7bnVtYmVyfQogICAgICovCiAgICBzZXQgc2xvcGUodmFsdWUpIHsKICAgICAgaWYoIWlzTmFOKHZhbHVlKSkgewogICAgICAgIGxldCBhbmdsZSA9IE1hdGguYXRhbih2YWx1ZSk7CiAgICAgICAgdGhpcy5hbmdsZSA9IGFuZ2xlOwogICAgICB9CiAgICB9CiAgICBnZXQgc2xvcGUoKSB7CiAgICAgIHJldHVybiB0aGlzLnkgLyB0aGlzLng7CiAgICB9CgogIH0KCgo8L3NjcmlwdD4KPHNjcmlwdD4KICBjbGFzcyBTaW11bGF0aW9uIHsKICAgIGNvbnN0cnVjdG9yKGVsKSB7CiAgICAgIGlmKGVsIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQgJiYgZWwubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2NhbnZhcycpIHsKICAgICAgICB0aGlzLmVsID0gZWw7CiAgICAgICAgdGhpcy5jdHggPSBlbC5nZXRDb250ZXh0KCcyZCcpOwoKICAgICAgICB0aGlzLmJvZGllcyA9IFtdOwoKICAgICAgICB0aGlzLnJ1biA9IHRoaXMucnVuLmJpbmQodGhpcyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgIH0KCiAgICBhZGRCb2R5KGJvZHkpIHsKICAgICAgaWYoYm9keSBpbnN0YW5jZW9mIEJvZHkpIHsKICAgICAgICBib2R5LnllYXJzUGVyRnJhbWUgPSB0aGlzLnllYXJzUGVyRnJhbWU7CiAgICAgICAgYm9keS5kaW1lbnNpb25zID0gdGhpcy5weGRpbWVuc2lvbnM7CiAgICAgICAgdGhpcy5ib2RpZXMucHVzaChib2R5KTsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5ib2RpZXMubGVuZ3RoLTE7CiAgICB9CiAgICByZW1vdmVCb2R5KGkpIHsKICAgICAgdGhpcy5ib2RpZXMuc3BsaWNlKGksMSk7CiAgICB9CgogICAgdXBkYXRlKCkgewogICAgICAvLyBTZXQgdXAgdGhlIGNhbnZhcyBmb3IgZHJhd2luZwogICAgICB0aGlzLmN0eC5maWxsU3R5bGUgPSBgcmdiYSgwLDEwLDIwLC45KWA7CiAgICAgIC8vIHRoaXMuY3R4LmNsZWFyUmVjdCgwLDAsdGhpcy5lbC53aWR0aCx0aGlzLmVsLmhlaWdodCk7CiAgICAgIHRoaXMuY3R4LmZpbGxSZWN0KDAsMCx0aGlzLmVsLndpZHRoLHRoaXMuZWwuaGVpZ2h0KTsKICAgICAgdGhpcy5jdHgudHJhbnNsYXRlKHRoaXMucHhkaW1lbnNpb25zLndpZHRoKi41LCB0aGlzLnB4ZGltZW5zaW9ucy5oZWlnaHQqLjUpOwoKCiAgICAgIGNvbnN0IGxpbmVUaHJlc2hvbGQgPSA4MDAwMDsKCiAgICAgIC8vIExvb3AgdGhyb3VnaCBhbGwgb2YgdGhlIGJvZGllcwogICAgICB0aGlzLmJvZGllcy5mb3JFYWNoKChib2R5WCkgPT4gewogICAgICAgIGNvbnN0IGFjY2VsZXJhdGlvbiA9IG5ldyBWZWN0b3IoMCwwKTsgLy8gVGhpcyBpcyBvdXIgYmFzYWwsIG5ldyBhY2NlbGVyYXRpb24gZm9yIHRoaXMgYm9keQogICAgICAgIC8vIEZvciBhbGwgdGhlIG90aGVyIGJvZGllcywgY2FsY3VsYXRlIHRoZSBjb21iaW5lZCBmb3JjZSBhc3NlcnRlZCBvbiB0aGlzCiAgICAgICAgdGhpcy5ib2RpZXMuZm9yRWFjaCgoYm9keVkpID0+IHsKICAgICAgICAgIGNvbnN0IGRpc3RhbmNlID0gYm9keVkucG9zaXRpb24uc3VidHJhY3ROZXcoYm9keVgucG9zaXRpb24pOyAvLyBUaGUgZGlzdGFuY2UgYmV0d2VlbiB0aGUgdHdvIGJvZGllcwogICAgICAgICAgY29uc3Qgc3FEID0gZGlzdGFuY2UubGVuZ3RoU3F1YXJlZDsgLy8gVGhlIGRpc3RhbmNlIHNxdWFyZWQgKGNoZWFwZXIgdGhhbiBjYWxjdWxhdGluZyBhY3R1YWwgZGlzdGFuY2UsIHNlZTogUHl0aGFnb3JhcykKICAgICAgICAgIGNvbnN0IGZvcmNlID0gKHRoaXMuZ3Jhdml0YXRpb25hbENvbnN0YW50ICogYm9keVkubWFzcykgLyAoc3FEICogTWF0aC5zcXJ0KHNxRCAqIHRoaXMuc21vb3RoaW5nKSk7IC8vIEhlcmUncyBzb21lIG5ld3RvbmlhbiBtb3Rpb24gd2l0aCBhIHNvbWUgc29mdGVuaW5nIHRvIHN0b3AgaXQgZnJvbSByZWFjaGluZyBpbmZpbml0eQoKICAgICAgICAgIGFjY2VsZXJhdGlvbi5hZGQoZGlzdGFuY2Uuc2NhbGUoZm9yY2UpKTsKCiAgICAgICAgICBpZihzcUQgPCBsaW5lVGhyZXNob2xkKSB7CiAgICAgICAgICAgIHRoaXMuY3R4LmJlZ2luUGF0aCgpOwogICAgICAgICAgICB0aGlzLmN0eC5zdHJva2VTdHlsZSA9IGByZ2JhKDI1NSwyNTUsMjU1LCR7KChsaW5lVGhyZXNob2xkLXNxRCkvbGluZVRocmVzaG9sZCkqLjV9KWA7CiAgICAgICAgICAgIHRoaXMuY3R4LmxpbmVXaWR0aCA9IDA7CiAgICAgICAgICAgIHRoaXMuY3R4Lm1vdmVUbyhib2R5WC5wb3NpdGlvbi54LCBib2R5WC5wb3NpdGlvbi55KTsKICAgICAgICAgICAgdGhpcy5jdHgubGluZVRvKGJvZHlZLnBvc2l0aW9uLngsIGJvZHlZLnBvc2l0aW9uLnkpOwogICAgICAgICAgICB0aGlzLmN0eC5zdHJva2UoKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICAvLyBVcGRhdGUgdGhlIGJhc2FsIGJvZHkncyBhY2NlbGFyYXRpb24gd2l0aCB0aGUgY2FsdWNhbHRlZCBmYWN0b3IKICAgICAgICBib2R5WC5hY2NlbGVyYXRpb24gPSBhY2NlbGVyYXRpb247CgogICAgICAgIC8vIERyYXcgdGhlIGJvZHkKICAgICAgICB0aGlzLmN0eC5iZWdpblBhdGgoKTsKICAgICAgICB0aGlzLmN0eC5maWxsU3R5bGUgPSBgcmdiYSgyMDAsMjU1LDI1NSwxKWA7CiAgICAgICAgdGhpcy5jdHguYXJjKGJvZHlYLnBvc2l0aW9uLngsIGJvZHlYLnBvc2l0aW9uLnksIGJvZHlYLnNpemUsIDAsIDIgKiBNYXRoLlBJKTsKICAgICAgICB0aGlzLmN0eC5maWxsKCk7CgogICAgICAgIC8vIFNvbHZlIGZvciB0aGUgbmV4dCBmcmFtZQogICAgICAgIGJvZHlYLnNvbHZlKCk7CiAgICAgIH0pOwogICAgICAvLyBSZXNldCBjdXJyZW50IHRyYW5zZm9ybWF0aW9uIG1hdHJpeCB0byB0aGUgaWRlbnRpdHkgbWF0cml4CiAgICAgIHRoaXMuY3R4LnNldFRyYW5zZm9ybSgxLCAwLCAwLCAxLCAwLCAwKTsKICAgIH0KCiAgICBydW4oZGVsdGEpIHsKICAgICAgaWYodGhpcy5ydW5uaW5nID09PSB0cnVlKSB7CiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMucnVuKTsKICAgICAgfQoKICAgICAgdGhpcy51cGRhdGUoKTsKICAgIH0KCiAgICBzZXQgcnVubmluZyh2YWx1ZSkgewogICAgICBpZih0aGlzLnJ1bm5pbmcgPT09IGZhbHNlICYmIHZhbHVlID09PSB0cnVlKSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5ydW4pOwogICAgICB0aGlzLl9ydW5uaW5nID0gdmFsdWUgPT09IHRydWU7CiAgICB9CiAgICBnZXQgcnVubmluZygpIHsKICAgICAgcmV0dXJuIHRoaXMuX3J1bm5pbmcgPT09IHRydWU7CiAgICB9CgogICAgc2V0IHB4cmF0aW8odmFsdWUpIHsKICAgICAgaWYoIWlzTmFOKHZhbHVlKSkgewogICAgICAgIHRoaXMuX3B4cmF0aW8gPSB2YWx1ZTsKICAgICAgfQogICAgfQogICAgZ2V0IHB4cmF0aW8oKSB7CiAgICAgIHJldHVybiB0aGlzLl9weHJhdGlvIHx8IDE7CiAgICB9CgogICAgc2V0IGRpbWVuc2lvbnModmFsdWUpIHsKICAgICAgaWYodmFsdWUgaW5zdGFuY2VvZiBWZWN0b3IpIHsKICAgICAgICB0aGlzLl9kaW1lbnNpb25zID0gdmFsdWU7CiAgICAgICAgdGhpcy5fcHhkaW1lbnNpb25zID0gdmFsdWUuc2NhbGUodGhpcy5weHJhdGlvKTsKICAgICAgICB0aGlzLmVsLndpZHRoID0gdGhpcy5fcHhkaW1lbnNpb25zLndpZHRoOwogICAgICAgIHRoaXMuZWwuaGVpZ2h0ID0gdGhpcy5fcHhkaW1lbnNpb25zLmhlaWdodDsKCiAgICAgICAgLy8gU2V0IHVwIHRoZSBjYW52YXMgZm9yIGRyYXdpbmcKICAgICAgICB0aGlzLmN0eC5maWxsU3R5bGUgPSBgcmdiYSgyMCwyMCwyMCwxKWA7CiAgICAgICAgLy8gdGhpcy5jdHguY2xlYXJSZWN0KDAsMCx0aGlzLmVsLndpZHRoLHRoaXMuZWwuaGVpZ2h0KTsKICAgICAgICB0aGlzLmN0eC5maWxsUmVjdCgwLDAsdGhpcy5lbC53aWR0aCx0aGlzLmVsLmhlaWdodCk7CiAgICAgIH0KICAgIH0KICAgIGdldCBkaW1lbnNpb25zKCkgewogICAgICByZXR1cm4gdGhpcy5fZGltZW5zaW9ucyB8fCBuZXcgVmVjdG9yKHRoaXMuZWwud2lkdGgvdGhpcy5weHJhdGlvLCB0aGlzLmVsLmhlaWdodC90aGlzLnB4cmF0aW8pOwogICAgfQoKICAgIGdldCBweGRpbWVuc2lvbnMoKSB7CiAgICAgIHJldHVybiB0aGlzLl9weGRpbWVuc2lvbnMgfHwgbmV3IFZlY3Rvcih0aGlzLmVsLndpZHRoLCB0aGlzLmVsLmhlaWdodCk7CiAgICB9CgogICAgc2V0IGdyYXZpdGF0aW9uYWxDb25zdGFudCh2YWx1ZSkgewogICAgICBpZighaXNOYU4odmFsdWUpKSB0aGlzLl9ncmF2aXRhdGlvbmFsQ29uc3RhbnQgPSB2YWx1ZTsKICAgIH0KICAgIGdldCBncmF2aXRhdGlvbmFsQ29uc3RhbnQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9ncmF2aXRhdGlvbmFsQ29uc3RhbnQgfHwgNDA7CiAgICB9CgogICAgc2V0IHNtb290aGluZyh2YWx1ZSkgewogICAgICBpZighaXNOYU4odmFsdWUpKSB0aGlzLl9zbW9vdGhpbmcgPSB2YWx1ZTsKICAgIH0KICAgIGdldCBzbW9vdGhpbmcoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zbW9vdGhpbmcgfHwgLjU7CiAgICB9CgogICAgc2V0IHllYXJzUGVyRnJhbWUodmFsdWUpIHsKICAgICAgaWYoIWlzTmFOKHZhbHVlKSkgdGhpcy5feWVhcnNQZXJGcmFtZSA9IHZhbHVlOwogICAgfQogICAgZ2V0IHllYXJzUGVyRnJhbWUoKSB7CiAgICAgIHJldHVybiB0aGlzLl95ZWFyc1BlckZyYW1lIHx8IC4yOwogICAgfQogIH0KCiAgY2xhc3MgQm9keSB7CiAgICBjb25zdHJ1Y3Rvcihwb3NpdGlvbiwgdmVsb2NpdHksIG1hc3MsIHNpemUsIGZpeGVkID0gZmFsc2UpIHsKICAgICAgdGhpcy5wb3NpdGlvbiA9IHBvc2l0aW9uOwogICAgICB0aGlzLnZlbG9jaXR5ID0gdmVsb2NpdHk7CiAgICAgIHRoaXMuYWNjZWxlcmF0aW9uID0gbmV3IFZlY3RvcigwLDApOwogICAgICB0aGlzLm1hc3MgPSBtYXNzOwogICAgICB0aGlzLnNpemUgPSBzaXplOwogICAgICB0aGlzLmZpeGVkID0gZml4ZWQ7CiAgICB9CgogICAgc29sdmUoKSB7CiAgICAgIGlmKHRoaXMuZml4ZWQpIHJldHVybjsKICAgICAgLy8gY29uc29sZS5sb2codGhpcy5hY2NlbGVyYXRpb24pCiAgICAgIGxldCB2ZWw9IHRoaXMudmVsb2NpdHkuYWRkTmV3KHRoaXMuYWNjZWxlcmF0aW9uLnNjYWxlTmV3KHRoaXMueWVhcnNQZXJGcmFtZSkpOwogICAgICB0aGlzLnZlbG9jaXR5ID0gdmVsOwogICAgICB0aGlzLnBvc2l0aW9uLmFkZCh0aGlzLnZlbG9jaXR5LnNjYWxlTmV3KHRoaXMueWVhcnNQZXJGcmFtZSkpOwogICAgICBpZih0aGlzLnBvc2l0aW9uLnggPiB0aGlzLmRpbWVuc2lvbnMueCAqIC41ICsgMzAuKSB7CiAgICAgICAgdGhpcy5wb3NpdGlvbi54ID0gdGhpcy5kaW1lbnNpb25zLnggKiAtLjUgLSAxMC47CiAgICAgIH0gZWxzZSBpZih0aGlzLnBvc2l0aW9uLnggPCB0aGlzLmRpbWVuc2lvbnMueCAqIC0uNSAtIDMwLikgewogICAgICAgIHRoaXMucG9zaXRpb24ueCA9IHRoaXMuZGltZW5zaW9ucy54ICogLjUgKyAxMC47CiAgICAgIH0KICAgICAgaWYodGhpcy5wb3NpdGlvbi55ID4gdGhpcy5kaW1lbnNpb25zLnkgKiAuNSArIDMwLikgewogICAgICAgIHRoaXMucG9zaXRpb24ueSA9IHRoaXMuZGltZW5zaW9ucy55ICogLS41IC0gMTAuOwogICAgICB9IGVsc2UgaWYodGhpcy5wb3NpdGlvbi55IDwgdGhpcy5kaW1lbnNpb25zLnkgKiAtLjUgLSAzMC4pIHsKICAgICAgICB0aGlzLnBvc2l0aW9uLnkgPSB0aGlzLmRpbWVuc2lvbnMueSAqIC41ICsgMTAuOwogICAgICB9CiAgICB9CgogICAgc2V0IGZpeGVkKHZhbHVlKSB7CiAgICAgIHRoaXMuX2ZpeGVkID0gdmFsdWUgPT09IHRydWU7CiAgICB9CiAgICBnZXQgZml4ZWQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9maXhlZCA9PT0gdHJ1ZTsKICAgIH0KCiAgICBzZXQgcG9zaXRpb24odmFsdWUpIHsKICAgICAgaWYodmFsdWUgaW5zdGFuY2VvZiBWZWN0b3IpIHsKICAgICAgICB0aGlzLl9wb3NpdGlvbiA9IHZhbHVlOwogICAgICB9CiAgICB9CiAgICBnZXQgcG9zaXRpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLl9wb3NpdGlvbiB8fCBudWxsOwogICAgfQoKICAgIHNldCBmcmljdGlvbih2YWx1ZSkgewogICAgICBpZighaXNOYU4odmFsdWUpKSB7CiAgICAgICAgdGhpcy5fZnJpY3Rpb24gPSB2YWx1ZTsKICAgICAgfQogICAgfQogICAgZ2V0IGZyaWN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5fZnJpY3Rpb24gfHwgLjk5OwogICAgfQoKICAgIHNldCBtYXhWZWxvY2l0eSh2YWx1ZSkgewogICAgICBpZighaXNOYU4odmFsdWUpKSB7CiAgICAgICAgdGhpcy5fbWF4VmVsb2NpdHkgPSB2YWx1ZTsKICAgICAgfQogICAgfQogICAgZ2V0IG1heFZlbG9jaXR5KCkgewogICAgICByZXR1cm4gdGhpcy5fbWF4VmVsb2NpdHkgfHwgNTAuOwogICAgfQoKICAgIHNldCB2ZWxvY2l0eSh2YWx1ZSkgewogICAgICBpZih2YWx1ZSBpbnN0YW5jZW9mIFZlY3RvcikgewogICAgICAgIGlmKHZhbHVlLmxlbmd0aCA+IHRoaXMubWF4VmVsb2NpdHkpIHZhbHVlLm5vcm1hbGlzZSgpLnNjYWxlKHRoaXMubWF4VmVsb2NpdHkpOwogICAgICAgIHZhbHVlLnNjYWxlKHRoaXMuZnJpY3Rpb24pOwogICAgICAgIHRoaXMuX3ZlbG9jaXR5ID0gdmFsdWU7CiAgICAgIH0KICAgIH0KICAgIGdldCB2ZWxvY2l0eSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3ZlbG9jaXR5IHx8IG51bGw7CiAgICB9CgogICAgc2V0IGFjY2VsZXJhdGlvbih2YWx1ZSkgewogICAgICBpZih2YWx1ZSBpbnN0YW5jZW9mIFZlY3RvcikgewogICAgICAgIHRoaXMuX2FjY2VsZXJhdGlvbiA9IHZhbHVlOwogICAgICB9CiAgICB9CiAgICBnZXQgYWNjZWxlcmF0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5fYWNjZWxlcmF0aW9uIHx8IG51bGw7CiAgICB9CgogICAgc2V0IG1hc3ModmFsdWUpIHsKICAgICAgaWYoIWlzTmFOKHZhbHVlKSkgewogICAgICAgIHRoaXMuX21hc3MgPSB2YWx1ZTsKICAgICAgfQogICAgfQogICAgZ2V0IG1hc3MoKSB7CiAgICAgIHJldHVybiB0aGlzLl9tYXNzIHx8IDA7CiAgICB9CgogICAgc2V0IHNpemUodmFsdWUpIHsKICAgICAgaWYoIWlzTmFOKHZhbHVlKSkgewogICAgICAgIHRoaXMuX3NpemUgPSB2YWx1ZTsKICAgICAgfQogICAgfQogICAgZ2V0IHNpemUoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zaXplIHx8IDA7CiAgICB9CgogICAgc2V0IHllYXJzUGVyRnJhbWUodmFsdWUpIHsKICAgICAgaWYoIWlzTmFOKHZhbHVlKSkgdGhpcy5feWVhcnNQZXJGcmFtZSA9IHZhbHVlOwogICAgfQogICAgZ2V0IHllYXJzUGVyRnJhbWUoKSB7CiAgICAgIHJldHVybiB0aGlzLl95ZWFyc1BlckZyYW1lIHx8IC4wMDg7CiAgICB9CiAgfQoKICAvL2NvbnNvbGUuY2xlYXIoKTsKCiAgY29uc3Qgc2ltID0gbmV3IFNpbXVsYXRpb24oZG9jdW1lbnQucXVlcnlTZWxlY3RvcignY2FudmFzJykpOwogIHNpbS5kaW1lbnNpb25zID0gbmV3IFZlY3Rvcih3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0KTsKICBjb25zb2xlLmxvZyhzaW0uZGltZW5zaW9ucykKICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgKGUpID0+IHsKICAgIHNpbS5kaW1lbnNpb25zID0gbmV3IFZlY3Rvcih3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0KTsKICB9KTsKCiAgbGV0IG1vdXNlQm9keSA9IG5ldyBCb2R5KG5ldyBWZWN0b3IoMCwgMCksIG5ldyBWZWN0b3IoMCwwKSwgLTEwMDAsIDUwLCB0cnVlKTsKICBsZXQgYm9keUluZGV4ID0gbnVsbDsKICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcmRvd24nLCAoZSkgPT4gewogICAgbW91c2VCb2R5LnBvc2l0aW9uLnggPSBlLnBhZ2VYIC0gd2luZG93LmlubmVyV2lkdGggKiAuNTsKICAgIG1vdXNlQm9keS5wb3NpdGlvbi55ID0gZS5wYWdlWSAtIHdpbmRvdy5pbm5lckhlaWdodCAqIC41OwogICAgY29uc29sZS5sb2cobW91c2VCb2R5LnBvc2l0aW9uKTsKICAgIGJvZHlJbmRleCA9IHNpbS5hZGRCb2R5KG1vdXNlQm9keSk7CiAgfSk7CiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJtb3ZlJywgKGUpID0+IHsKICAgIG1vdXNlQm9keS5wb3NpdGlvbi54ID0gZS5wYWdlWCAtIHdpbmRvdy5pbm5lcldpZHRoICogLjU7CiAgICBtb3VzZUJvZHkucG9zaXRpb24ueSA9IGUucGFnZVkgLSB3aW5kb3cuaW5uZXJIZWlnaHQgKiAuNTsKICB9KTsKICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcnVwJywgKGUpID0+IHsKICAgIHNpbS5yZW1vdmVCb2R5KGJvZHlJbmRleCk7CiAgICBib2R5SW5kZXggPSBudWxsOwogIH0pOwoKICAvLyBzaW0uYWRkQm9keShuZXcgQm9keShuZXcgVmVjdG9yKDAsIDApLCBuZXcgVmVjdG9yKDAsMCksIC0zLCA1MCwgdHJ1ZSkpOwogIC8vIHNpbS5hZGRCb2R5KG5ldyBCb2R5KG5ldyBWZWN0b3IoMCwgNTAwKSwgbmV3IFZlY3RvcigwLDApLCAxLCAxMCwgdHJ1ZSkpOwoKICBmb3IoaT0wO2k8d2luZG93LmlubmVyV2lkdGggKiB3aW5kb3cuaW5uZXJIZWlnaHQgKiAwLjAwMDA4O2krKykgewogICAgY29uc3QgciA9IG5ldyBWZWN0b3IoNDAwICsgTWF0aC5yYW5kb20oKSAqIDUwMCwgTWF0aC5yYW5kb20oKSAqIE1hdGguUEkgKiAyLik7CiAgICBjb25zdCBwID0gbmV3IFZlY3RvcihNYXRoLmNvcyhyLnkpICogci54LCBNYXRoLnNpbihyLnkpICogci54KTsKICAgIGNvbnN0IGEgPSBuZXcgVmVjdG9yKHAueSwgLXAueCkubm9ybWFsaXNlKCkuc2NhbGUoMTAuKTsKICAgIC8vIGNvbnN0IGEgPSBuZXcgVmVjdG9yKDAsMCk7CiAgICBjb25zdCByZiA9IE1hdGgucmFuZG9tKCk7CiAgICBzaW0uYWRkQm9keShuZXcgQm9keShwLCBhLCAtMTAgKyByZiAqIDE1LiwgMSArIHJmICogMTApKTsKICAgIC8vIHNpbS5hZGRCb2R5KG5ldyBCb2R5KHAsIGEsIC41ICsgcmYgKiAuNSwgNSArIHJmICogNS4pKTsKCiAgfQoKICBzaW0ucnVubmluZyA9IHRydWU7Cjwvc2NyaXB0PgoKPGRpdiBjbGFzcz0iY2FyZC1iYWNrIj4KICA8aDE+Q2xhc2jphY3nva7mlofku7bono3lkIg8L2gxPgoKICA8IS0tIOino+eggemDqOWIhiAtLT4KICA8ZGl2IGlkPSJpbnB1dC1jb250YWluZXIiPgogICAgPCEtLSDliJ3lp4vovpPlhaXmoYYgLS0+CiAgICA8ZGl2IGNsYXNzPSJpbnB1dC1ncm91cCI+CiAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBjbGFzcz0iaW5wdXQtZmllbGQiIHBsYWNlaG9sZGVyPSLnspjotLTorqLpmIXpk77mjqUiPgogICAgPC9kaXY+CiAgPC9kaXY+CgogIDxkaXYgY2xhc3M9ImlucHV0LWdyb3VwIj4KICAgIDxidXR0b24gb25jbGljaz0iYWRkSW5wdXQoKSI+4p6VPC9idXR0b24+CiAgICA8YnV0dG9uIG9uY2xpY2s9ImNvcHlMaW5rKCkiPuiejeWQiOmFjee9rjwvYnV0dG9uPgoKICA8L2Rpdj4KICA8ZGl2IGlkPSJxcmNvZGUiPjwvZGl2PgoKCjwvZGl2PgoKCjxzY3JpcHQ+CiAgLy8g6I635Y+W6L6T5YWl5qGG5a655ZmoCiAgY29uc3QgaW5wdXRDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5wdXQtY29udGFpbmVyJyk7CgogIC8vIOa3u+WKoOi+k+WFpeahhgogIGZ1bmN0aW9uIGFkZElucHV0KCkgewogICAgLy8g6I635Y+W5pyA5ZCO5LiA5Liq6L6T5YWl57uECiAgICBjb25zdCBsYXN0SW5wdXRHcm91cCA9IGlucHV0Q29udGFpbmVyLmxhc3RFbGVtZW50Q2hpbGQ7CgogICAgLy8g5Yib5bu65paw55qE6L6T5YWl57uECiAgICBjb25zdCBuZXdJbnB1dEdyb3VwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICBuZXdJbnB1dEdyb3VwLmNsYXNzTmFtZSA9ICdpbnB1dC1ncm91cCc7CgogICAgLy8g5Yib5bu65paw55qE6L6T5YWl5qGGCiAgICBjb25zdCBuZXdJbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7CiAgICBuZXdJbnB1dC50eXBlID0gJ3RleHQnOwogICAgbmV3SW5wdXQuY2xhc3NOYW1lID0gJ2lucHV0LWZpZWxkJzsKICAgIG5ld0lucHV0LnBsYWNlaG9sZGVyID0gJ+eymOi0tOiuoumYhemTvuaOpSc7CgogICAgLy8g5Yib5bu66YCX5Y+35oyJ6ZKuCiAgICBjb25zdCBjb21tYUJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgY29tbWFCdXR0b24uZGlzYWJsZWQgPSB0cnVlOyAvLyDnpoHnlKjmjInpkq4KICAgIGNvbW1hQnV0dG9uLnRleHRDb250ZW50ID0gJ++8jCc7IC8vIOmAl+WPt+ihqOaDheespuWPtwogICAgY29tbWFCdXR0b24uY2xhc3NOYW1lID0gJ2NvbW1hLWJ1dHRvbic7CgogICAgLy8g5bCG6YCX5Y+35oyJ6ZKu5re75Yqg5Yiw5LiK5LiA5Liq6L6T5YWl57uE55qE5pyr5bC+CiAgICBpZiAobGFzdElucHV0R3JvdXApIHsKICAgICAgbGFzdElucHV0R3JvdXAuYXBwZW5kQ2hpbGQoY29tbWFCdXR0b24pOwogICAgfQoKICAgIC8vIOWwhuaWsOeahOi+k+WFpeahhua3u+WKoOWIsOaWsOeahOi+k+WFpee7hAogICAgbmV3SW5wdXRHcm91cC5hcHBlbmRDaGlsZChuZXdJbnB1dCk7CgogICAgLy8g5bCG5paw55qE6L6T5YWl57uE5re75Yqg5Yiw5a655Zmo5LitCiAgICBpbnB1dENvbnRhaW5lci5hcHBlbmRDaGlsZChuZXdJbnB1dEdyb3VwKTsKICB9CgogIC8vIOWkjeWItumTvuaOpeWIsOWJqui0tOadvwogIGZ1bmN0aW9uIGNvcHlMaW5rKCkgewogICAgY29uc3QgaW5wdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmlucHV0LWZpZWxkJyk7CiAgICBjb25zdCBsaW5rcyA9IEFycmF5LmZyb20oaW5wdXRzKS5tYXAoaW5wdXQgPT4gaW5wdXQudmFsdWUudHJpbSgpKS5maWx0ZXIodmFsdWUgPT4gdmFsdWUgIT09ICcnKTsKICAgIGNvbnN0IGNvbWJpbmVkTGlua3MgPSBsaW5rcy5qb2luKCcsJyk7CgogICAgY29uc3QgbGluayA9IGAke3dpbmRvdy5sb2NhdGlvbi5vcmlnaW59Lz9saW5rcz0ke2VuY29kZVVSSUNvbXBvbmVudChjb21iaW5lZExpbmtzKX1gOwoKICAgIC8vIOWkjeWItumTvuaOpeWIsOWJqui0tOadvwogICAgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQobGluayk7CiAgICBjb25zb2xlLmxvZyhsaW5rKTsKICAgIHZhciBxciA9IHFyY29kZSgxMiwgIk0iKTsKICAgIHFyLmFkZERhdGEobGluayk7CiAgICBxci5tYWtlKCk7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicXJjb2RlIikuaW5uZXJIVE1MID0gcXIuY3JlYXRlSW1nVGFnKCk7CiAgfQo8L3NjcmlwdD4KPC9ib2R5Pgo8L2h0bWw+
`